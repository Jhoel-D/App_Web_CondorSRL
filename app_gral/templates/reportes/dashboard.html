{% extends 'base/base_home.html' %}

{% block title %}Dashboard Ejecutivo - Sistema CONDOR{% endblock %}

{% block content %}
<div class="container-fluid">
    <!-- Header -->
    <div class="row mb-4">
        <div class="col-12">
            <div class="d-flex justify-content-between align-items-center">
                <div>
                    <h2 class="mb-1"><i class="fas fa-chart-line me-2"></i>Dashboard Ejecutivo</h2>
                    <p class="text-muted mb-0">Resumen ejecutivo del rendimiento empresarial</p>
                </div>
                <div class="d-flex gap-2">
                    <select class="form-select" style="width: auto;">
                        <option>Último mes</option>
                        <option>Últimos 3 meses</option>
                        <option>Último año</option>
                        <option>Personalizado</option>
                    </select>
                    <button class="btn btn-primary">
                        <i class="fas fa-download me-1"></i>Exportar
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- KPIs Principales -->
    <div class="row mb-4">
        <div class="col-xl-3 col-md-6 mb-3">
            <div class="card border-0 shadow-sm h-100">
                <div class="card-body">
                    <div class="d-flex align-items-center">
                        <div class="flex-shrink-0">
                            <div class="bg-primary bg-opacity-10 rounded-3 p-3">
                                <i class="fas fa-dollar-sign text-primary fs-4"></i>
                            </div>
                        </div>
                        <div class="flex-grow-1 ms-3">
                            <h6 class="text-muted mb-1">Ingresos Totales</h6>
                            <h4 class="mb-0">$2,847,500</h4>
                            <small class="text-success">
                                <i class="fas fa-arrow-up me-1"></i>+12.5%
                            </small>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="col-xl-3 col-md-6 mb-3">
            <div class="card border-0 shadow-sm h-100">
                <div class="card-body">
                    <div class="d-flex align-items-center">
                        <div class="flex-shrink-0">
                            <div class="bg-success bg-opacity-10 rounded-3 p-3">
                                <i class="fas fa-shopping-cart text-success fs-4"></i>
                            </div>
                        </div>
                        <div class="flex-grow-1 ms-3">
                            <h6 class="text-muted mb-1">Ventas Realizadas</h6>
                            <h4 class="mb-0">1,247</h4>
                            <small class="text-success">
                                <i class="fas fa-arrow-up me-1"></i>+8.3%
                            </small>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="col-xl-3 col-md-6 mb-3">
            <div class="card border-0 shadow-sm h-100">
                <div class="card-body">
                    <div class="d-flex align-items-center">
                        <div class="flex-shrink-0">
                            <div class="bg-info bg-opacity-10 rounded-3 p-3">
                                <i class="fas fa-users text-info fs-4"></i>
                            </div>
                        </div>
                        <div class="flex-grow-1 ms-3">
                            <h6 class="text-muted mb-1">Clientes Activos</h6>
                            <h4 class="mb-0">892</h4>
                            <small class="text-success">
                                <i class="fas fa-arrow-up me-1"></i>+15.2%
                            </small>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="col-xl-3 col-md-6 mb-3">
            <div class="card border-0 shadow-sm h-100">
                <div class="card-body">
                    <div class="d-flex align-items-center">
                        <div class="flex-shrink-0">
                            <div class="bg-warning bg-opacity-10 rounded-3 p-3">
                                <i class="fas fa-boxes text-warning fs-4"></i>
                            </div>
                        </div>
                        <div class="flex-grow-1 ms-3">
                            <h6 class="text-muted mb-1">Productos en Stock</h6>
                            <h4 class="mb-0">2,156</h4>
                            <small class="text-danger">
                                <i class="fas fa-arrow-down me-1"></i>-3.1%
                            </small>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Gráficos Principales -->
    <div class="row mb-4">
        <div class="col-xl-8 mb-3">
            <div class="card border-0 shadow-sm h-100">
                <div class="card-header bg-transparent border-0 pb-0">
                    <div class="d-flex justify-content-between align-items-center">
                        <h5 class="mb-0"><i class="fas fa-chart-area me-2"></i>Tendencia de Ventas</h5>
                        <div class="btn-group btn-group-sm" role="group">
                            <input type="radio" class="btn-check" name="periodo" id="mes" checked>
                            <label class="btn btn-outline-primary" for="mes">Mes</label>
                            <input type="radio" class="btn-check" name="periodo" id="trimestre">
                            <label class="btn btn-outline-primary" for="trimestre">Trimestre</label>
                            <input type="radio" class="btn-check" name="periodo" id="ano">
                            <label class="btn btn-outline-primary" for="ano">Año</label>
                        </div>
                    </div>
                </div>
                <div class="card-body">
                    <canvas id="ventasChart" height="300"></canvas>
                </div>
            </div>
        </div>
        
        <div class="col-xl-4 mb-3">
            <div class="card border-0 shadow-sm h-100">
                <div class="card-header bg-transparent border-0 pb-0">
                    <h5 class="mb-0"><i class="fas fa-chart-pie me-2"></i>Distribución por Categoría</h5>
                </div>
                <div class="card-body">
                    <canvas id="categoriasChart" height="300"></canvas>
                </div>
            </div>
        </div>
    </div>

    <!-- Resumen por Módulos -->
    <div class="row mb-4">
        <div class="col-12">
            <div class="card border-0 shadow-sm">
                <div class="card-header bg-transparent border-0">
                    <h5 class="mb-0"><i class="fas fa-th-large me-2"></i>Resumen por Módulos</h5>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-lg-3 col-md-6 mb-3">
                            <div class="border rounded-3 p-3 h-100">
                                <div class="d-flex align-items-center mb-2">
                                    <i class="fas fa-users text-primary me-2"></i>
                                    <h6 class="mb-0">Usuarios</h6>
                                </div>
                                <div class="row text-center">
                                    <div class="col-6">
                                        <div class="border-end">
                                            <h5 class="mb-0 text-primary">45</h5>
                                            <small class="text-muted">Activos</small>
                                        </div>
                                    </div>
                                    <div class="col-6">
                                        <h5 class="mb-0 text-muted">52</h5>
                                        <small class="text-muted">Total</small>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-lg-3 col-md-6 mb-3">
                            <div class="border rounded-3 p-3 h-100">
                                <div class="d-flex align-items-center mb-2">
                                    <i class="fas fa-box text-success me-2"></i>
                                    <h6 class="mb-0">Productos</h6>
                                </div>
                                <div class="row text-center">
                                    <div class="col-6">
                                        <div class="border-end">
                                            <h5 class="mb-0 text-success">2,156</h5>
                                            <small class="text-muted">En Stock</small>
                                        </div>
                                    </div>
                                    <div class="col-6">
                                        <h5 class="mb-0 text-muted">2,890</h5>
                                        <small class="text-muted">Total</small>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-lg-3 col-md-6 mb-3">
                            <div class="border rounded-3 p-3 h-100">
                                <div class="d-flex align-items-center mb-2">
                                    <i class="fas fa-handshake text-info me-2"></i>
                                    <h6 class="mb-0">Clientes</h6>
                                </div>
                                <div class="row text-center">
                                    <div class="col-6">
                                        <div class="border-end">
                                            <h5 class="mb-0 text-info">892</h5>
                                            <small class="text-muted">Activos</small>
                                        </div>
                                    </div>
                                    <div class="col-6">
                                        <h5 class="mb-0 text-muted">1,245</h5>
                                        <small class="text-muted">Total</small>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-lg-3 col-md-6 mb-3">
                            <div class="border rounded-3 p-3 h-100">
                                <div class="d-flex align-items-center mb-2">
                                    <i class="fas fa-clipboard-list text-warning me-2"></i>
                                    <h6 class="mb-0">Pedidos</h6>
                                </div>
                                <div class="row text-center">
                                    <div class="col-6">
                                        <div class="border-end">
                                            <h5 class="mb-0 text-warning">127</h5>
                                            <small class="text-muted">Pendientes</small>
                                        </div>
                                    </div>
                                    <div class="col-6">
                                        <h5 class="mb-0 text-muted">1,247</h5>
                                        <small class="text-muted">Total</small>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Alertas y Notificaciones -->
    <div class="row mb-4">
        <div class="col-lg-6 mb-3">
            <div class="card border-0 shadow-sm h-100">
                <div class="card-header bg-transparent border-0">
                    <h5 class="mb-0"><i class="fas fa-exclamation-triangle me-2"></i>Alertas Importantes</h5>
                </div>
                <div class="card-body">
                    <div class="alert alert-warning d-flex align-items-center mb-3" role="alert">
                        <i class="fas fa-box-open me-2"></i>
                        <div>
                            <strong>Stock Bajo:</strong> 15 productos con menos de 10 unidades
                        </div>
                    </div>
                    <div class="alert alert-info d-flex align-items-center mb-3" role="alert">
                        <i class="fas fa-clock me-2"></i>
                        <div>
                            <strong>Pedidos Pendientes:</strong> 8 pedidos requieren atención
                        </div>
                    </div>
                    <div class="alert alert-success d-flex align-items-center mb-0" role="alert">
                        <i class="fas fa-chart-line me-2"></i>
                        <div>
                            <strong>Meta Alcanzada:</strong> Ventas del mes superaron el objetivo
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="col-lg-6 mb-3">
            <div class="card border-0 shadow-sm h-100">
                <div class="card-header bg-transparent border-0">
                    <h5 class="mb-0"><i class="fas fa-trophy me-2"></i>Top Productos</h5>
                </div>
                <div class="card-body">
                    <div class="d-flex justify-content-between align-items-center mb-3 pb-2 border-bottom">
                        <div class="d-flex align-items-center">
                            <span class="badge bg-primary rounded-pill me-2">1</span>
                            <span>Producto Premium A</span>
                        </div>
                        <span class="text-success fw-bold">$45,200</span>
                    </div>
                    <div class="d-flex justify-content-between align-items-center mb-3 pb-2 border-bottom">
                        <div class="d-flex align-items-center">
                            <span class="badge bg-secondary rounded-pill me-2">2</span>
                            <span>Producto Estándar B</span>
                        </div>
                        <span class="text-success fw-bold">$38,750</span>
                    </div>
                    <div class="d-flex justify-content-between align-items-center mb-3 pb-2 border-bottom">
                        <div class="d-flex align-items-center">
                            <span class="badge bg-warning rounded-pill me-2">3</span>
                            <span>Producto Básico C</span>
                        </div>
                        <span class="text-success fw-bold">$32,100</span>
                    </div>
                    <div class="d-flex justify-content-between align-items-center mb-0">
                        <div class="d-flex align-items-center">
                            <span class="badge bg-info rounded-pill me-2">4</span>
                            <span>Producto Especial D</span>
                        </div>
                        <span class="text-success fw-bold">$28,900</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Actividad Reciente -->
    <div class="row">
        <div class="col-12">
            <div class="card border-0 shadow-sm">
                <div class="card-header bg-transparent border-0">
                    <h5 class="mb-0"><i class="fas fa-history me-2"></i>Actividad Reciente</h5>
                </div>
                <div class="card-body">
                    <div class="table-responsive">
                        <table class="table table-hover">
                            <thead class="table-light">
                                <tr>
                                    <th><i class="fas fa-clock me-1"></i>Hora</th>
                                    <th><i class="fas fa-user me-1"></i>Usuario</th>
                                    <th><i class="fas fa-cog me-1"></i>Acción</th>
                                    <th><i class="fas fa-folder me-1"></i>Módulo</th>
                                    <th><i class="fas fa-info-circle me-1"></i>Estado</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>14:30</td>
                                    <td>Juan Pérez</td>
                                    <td>Nueva venta registrada</td>
                                    <td><span class="badge bg-success">Ventas</span></td>
                                    <td><i class="fas fa-check-circle text-success"></i></td>
                                </tr>
                                <tr>
                                    <td>14:15</td>
                                    <td>María García</td>
                                    <td>Producto actualizado</td>
                                    <td><span class="badge bg-primary">Productos</span></td>
                                    <td><i class="fas fa-check-circle text-success"></i></td>
                                </tr>
                                <tr>
                                    <td>13:45</td>
                                    <td>Carlos López</td>
                                    <td>Cliente registrado</td>
                                    <td><span class="badge bg-info">Clientes</span></td>
                                    <td><i class="fas fa-check-circle text-success"></i></td>
                                </tr>
                                <tr>
                                    <td>13:20</td>
                                    <td>Ana Martínez</td>
                                    <td>Pedido procesado</td>
                                    <td><span class="badge bg-warning">Pedidos</span></td>
                                    <td><i class="fas fa-clock text-warning"></i></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
// Gráfico de Tendencia de Ventas
const ventasCtx = document.getElementById('ventasChart').getContext('2d');
new Chart(ventasCtx, {
    type: 'line',
    data: {
        labels: ['Ene', 'Feb', 'Mar', 'Abr', 'May', 'Jun', 'Jul', 'Ago', 'Sep', 'Oct', 'Nov', 'Dic'],
        datasets: [{
            label: 'Ventas 2024',
            data: [180000, 195000, 210000, 185000, 220000, 245000, 260000, 275000, 290000, 285000, 310000, 325000],
            borderColor: '#0d6efd',
            backgroundColor: 'rgba(13, 110, 253, 0.1)',
            tension: 0.4,
            fill: true
        }, {
            label: 'Ventas 2023',
            data: [165000, 170000, 185000, 175000, 190000, 205000, 220000, 235000, 250000, 245000, 265000, 280000],
            borderColor: '#6c757d',
            backgroundColor: 'rgba(108, 117, 125, 0.1)',
            tension: 0.4,
            fill: false
        }]
    },
    options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
            legend: {
                position: 'top',
            }
        },
        scales: {
            y: {
                beginAtZero: true,
                ticks: {
                    callback: function(value) {
                        return '$' + value.toLocaleString();
                    }
                }
            }
        }
    }
});

// Gráfico de Distribución por Categoría
const categoriasCtx = document.getElementById('categoriasChart').getContext('2d');
new Chart(categoriasCtx, {
    type: 'doughnut',
    data: {
        labels: ['Electrónicos', 'Ropa', 'Hogar', 'Deportes', 'Libros'],
        datasets: [{
            data: [35, 25, 20, 15, 5],
            backgroundColor: [
                '#0d6efd',
                '#198754',
                '#ffc107',
                '#dc3545',
                '#6f42c1'
            ]
        }]
    },
    options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
            legend: {
                position: 'bottom',
            }
        }
    }
});
</script>
{% endblock %}
